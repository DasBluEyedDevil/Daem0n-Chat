---
phase: 09-distribution-packaging
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - installer/manifest.json
  - installer/build_mcpb.py
  - installer/icon.py
autonomous: true

must_haves:
  truths:
    - "MCPB manifest.json declares DaemonChat as a uv-type server with correct entry point and tool list"
    - "build_mcpb.py can produce a .mcpb bundle file from the project source using the manifest"
    - "Manifest includes all 8 daem0n_* tools with user-facing descriptions"
  artifacts:
    - path: "installer/manifest.json"
      provides: "MCPB Desktop Extension manifest"
      contains: "daem0n-chat"
    - path: "installer/build_mcpb.py"
      provides: "Build script for .mcpb bundle"
      contains: "mcpb pack"
  key_links:
    - from: "installer/manifest.json"
      to: "daem0nmcp/server.py"
      via: "entry_point field"
      pattern: "entry_point"
    - from: "installer/build_mcpb.py"
      to: "installer/manifest.json"
      via: "reads manifest for build"
      pattern: "manifest"
---

<objective>
Create the MCPB Desktop Extension packaging for one-click installation via Claude Desktop's Extensions UI.

Purpose: MCPB is Anthropic's official distribution format. When the uv server type matures, this gives users a true one-click install experience -- drag .mcpb file into Claude Desktop.
Output: A manifest.json and build script that can produce a .mcpb bundle.
</objective>

<execution_context>
@C:\Users\dasbl\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\dasbl\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-distribution-packaging/09-RESEARCH.md
@.planning/phases/09-distribution-packaging/09-01-SUMMARY.md
@pyproject.toml
@daem0nmcp/server.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MCPB manifest and build script</name>
  <files>installer/manifest.json, installer/build_mcpb.py, installer/icon.py</files>
  <action>
    1. `installer/manifest.json`: Create the MCPB Desktop Extension manifest following the spec from research.
       ```json
       {
           "manifest_version": "0.3",
           "name": "daem0n-chat",
           "display_name": "DaemonChat - Conversational Memory",
           "version": "1.0.0",
           "description": "Claude remembers you. Persistent conversational memory that builds across sessions -- your name, interests, concerns, relationships, and communication style.",
           "author": {
               "name": "DasBluEyedDevil",
               "url": "https://github.com/DasBluEyedDevil/Daem0n-Chat"
           },
           "server": {
               "type": "uv",
               "entry_point": "server.py"
           },
           "tools": [
               {"name": "daem0n_briefing", "description": "Start session with personalized briefing"},
               {"name": "daem0n_remember", "description": "Store a memory about the user"},
               {"name": "daem0n_recall", "description": "Retrieve relevant memories"},
               {"name": "daem0n_forget", "description": "Remove specific memories"},
               {"name": "daem0n_profile", "description": "Manage user profile and preferences"},
               {"name": "daem0n_status", "description": "Check system health and statistics"},
               {"name": "daem0n_relate", "description": "Query relationship graph"},
               {"name": "daem0n_reflect", "description": "Analyze patterns and connections"}
           ],
           "tools_generated": false,
           "compatibility": {
               "platforms": ["win32"],
               "runtimes": {
                   "python": ">=3.10,<3.14"
               }
           },
           "license": "MIT",
           "keywords": ["memory", "conversation", "personal", "companion"]
       }
       ```

    2. `installer/build_mcpb.py`: Build script that prepares and packages the .mcpb bundle.
       - Function `prepare_build_dir(build_dir: Path)`: Creates a temporary build directory, copies the project source files needed: `daem0nmcp/` directory (excluding __pycache__, .pyc), `pyproject.toml`, `installer/manifest.json` (as `manifest.json` in root). Also creates a minimal `server.py` wrapper at the build root that imports and runs the server: `from daem0nmcp.server import main; main()`.
       - Function `build_mcpb(output_dir: Path = None)`: Calls prepare_build_dir, then runs `mcpb pack` CLI command (via subprocess) on the build directory. If `mcpb` is not installed, print a clear error: "Install MCPB CLI: npm install -g @anthropic-ai/mcpb". Moves the output .mcpb file to output_dir (default: project root `dist/`).
       - `if __name__ == "__main__"` block with argparse: `--output-dir` option.
       - Import shutil and subprocess. Use tempfile.mkdtemp for build directory, clean up after.
       - Print progress messages: "Preparing build directory...", "Running mcpb pack...", "Built: dist/daem0n-chat.mcpb"
       - NOTE: This script may fail if mcpb CLI is not installed -- that is expected. The script itself must be correct and runnable. Do NOT install mcpb as part of this task.

    3. `installer/icon.py`: A utility script that generates a simple placeholder icon.
       - Function `create_placeholder_icon(path: Path)`: Creates a minimal 512x512 PNG icon file. Use a simple approach: create a 1x1 pixel PNG with Python's built-in capabilities (write the minimal PNG binary header for a solid-color pixel), or simply create a text file explaining an icon is needed. The actual icon design is a user concern.
       - Keep this minimal -- just `create_placeholder_icon()` that writes a note file `installer/icon_needed.txt` explaining "Place a 512x512 PNG icon at installer/icon.png for the MCPB Desktop Extension."
       - This is intentionally lightweight. Real icon is a user/design decision.
  </action>
  <verify>
    Run `python -c "import json; m = json.load(open('installer/manifest.json')); assert m['name'] == 'daem0n-chat'; assert len(m['tools']) == 8; print('Manifest OK')"`.
    Run `python installer/build_mcpb.py --help` -- should show usage without error.
  </verify>
  <done>manifest.json declares DaemonChat with all 8 tools and uv server type. build_mcpb.py can prepare build directory and invoke mcpb pack. Icon placeholder exists.</done>
</task>

</tasks>

<verification>
1. `installer/manifest.json` is valid JSON with all 8 tool names matching actual tool function names
2. `python installer/build_mcpb.py --help` runs without import errors
3. Tool names in manifest match the actual tool names registered in server.py
</verification>

<success_criteria>
- manifest.json exists with correct structure (manifest_version, server type uv, 8 tools)
- build_mcpb.py can prepare a build directory with all needed source files
- build_mcpb.py gracefully handles missing mcpb CLI (clear error message)
</success_criteria>

<output>
After completion, create `.planning/phases/09-distribution-packaging/09-02-SUMMARY.md`
</output>
